<section class="card">
  <h2>افزودن کاربر توسط ادمین</h2>
  <p class="muted">فرم ایجاد حساب کاربری جدید (بر اساس API ثبت‌نام).</p>

  <form (ngSubmit)="submit()" #registerForm="ngForm">
    <div class="grid">
      <label>
        نام
        <input type="text" name="firstName" required [(ngModel)]="model.firstName" />
      </label>

      <label>
        نام خانوادگی
        <input type="text" name="lastName" required [(ngModel)]="model.lastName" />
      </label>

      <label>
        ایمیل
        <input type="email" name="email" required [(ngModel)]="model.email" />
      </label>

      <label>
        تلفن
        <input type="tel" name="phoneNumber" [(ngModel)]="model.phoneNumber" />
      </label>

      <label>
        رمز عبور
        <input type="password" name="password" required minlength="6" [(ngModel)]="model.password" />
      </label>

      <label>
        تکرار رمز عبور
        <input
          type="password"
          name="confirmPassword"
          required
          minlength="6"
          [(ngModel)]="model.confirmPassword"
        />
      </label>

      <label>
        کد ملی
        <input type="text" name="nationalCode" [(ngModel)]="model.nationalCode" />
      </label>

      <label class="date-picker-field">
        تاریخ تولد
        <input
          type="text"
          name="birthDate"
          placeholder="مثال: 1403/01/01"
          [(ngModel)]="birthDateInput"
          (blur)="normalizeBirthDateInput()"
          (click)="openDatePicker(); $event.stopPropagation()"
          (focus)="openDatePicker()"
        />
        <div class="jalali-datepicker" *ngIf="activeDatePicker" (click)="$event.stopPropagation()">
          <div class="calendar-header">
            <button type="button" (click)="changeDatePickerMonth(-1)">
              &lt;
            </button>
            <div class="calendar-selects">
              <select
                class="calendar-select"
                [value]="datePickerMonth"
                (change)="onDatePickerMonthChange($event.target.value)"
              >
                <option *ngFor="let month of datePickerMonths; let idx = index" [value]="idx + 1">
                  {{ month }}
                </option>
              </select>
              <select
                class="calendar-select"
                [value]="datePickerYear"
                (change)="onDatePickerYearChange($event.target.value)"
              >
                <option *ngFor="let year of datePickerYears" [value]="year">
                  {{ year }}
                </option>
              </select>
            </div>
            <button type="button" (click)="changeDatePickerMonth(1)">
              &gt;
            </button>
          </div>
          <div class="calendar-grid">
            <span class="weekday" *ngFor="let day of datePickerWeekdays">{{ day }}</span>
            <span class="empty" *ngFor="let empty of datePickerLeadingDays"></span>
            <button
              type="button"
              class="day"
              *ngFor="let day of datePickerDays"
              [class.selected]="isDatePickerSelected(day)"
              [class.today]="isDatePickerToday(day)"
              (click)="selectDatePickerDay(day)"
            >
              {{ day }}
            </button>
          </div>
        </div>
      </label>

      <label class="full">
        آدرس
        <textarea name="address" rows="3" [(ngModel)]="model.address"></textarea>
      </label>
    </div>

    <button type="submit" [disabled]="registerForm.invalid || isLoading">
      {{ isLoading ? 'در حال ایجاد...' : 'ایجاد کاربر' }}
    </button>
  </form>

  <p class="success" *ngIf="successMessage">{{ successMessage }}</p>
  <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>
</section>
